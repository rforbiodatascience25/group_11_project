---
title: "05_analyse_1"
format: html
---

```{r}
#| message: false

library(tidyverse)
library(ggplot2)
aug_exp <- read_csv("../data/03_expression_augment_data.csv")
```

```{r}
#| cache: true
aug_exp |> 
  #slice_head(n = 20) |> 
  pivot_longer(cols = -X,
               names_to = "sample",
               values_to = "expression") |> 
  pivot_wider(names_from = X,
              values_from = expression) |> 
  column_to_rownames(var = "sample") |> 
  cor() |> 
  as.data.frame() |> 
  rownames_to_column(var = "transcript1") |> 
  pivot_longer(cols = -transcript1,
               names_to = "transcripts",
               values_to = "correlation") |> 

  ggplot( mapping = aes(x = transcripts,
                        y = transcript1,
                        fill = correlation))+
  geom_tile()+
  scale_fill_gradient2(
    limits = c(-1,1),
    midpoint = 0,
    low = "black",
    mid = "white",
    high = "red"
  )+
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank())+
  labs(title = "Co-expression of transcripts")
```
