---
title: "02_clean"
format: html
---

# clean data

```{r}
library(tidyverse)
```

## join expression and meta data

```{r}
ri_expression_data |> 
  pivot_longer(cols = -X,
               names_to = "sample",
               values_to = "expression") |> 
  inner_join(ri_metadata, by = c("sample" = "GC.code" )) |> 
  filter(Exp == "RI_batch_WC") |> 
  select(X,expression,sample) |> 
  pivot_wider(names_from = sample,
              values_from = expression) |> 
  write_csv("../data/02_expression_data_clean.csv")
```

## Clean annotation data

```{r}
ri_clean <- ri_annotation |>
  select(gene_ids, ko) |>
  mutate(
    ko = ifelse(ko == "-", NA, ko)
  ) |>
  drop_na(ko) |>
  write_csv("../data/02_annotation_data_clean.csv")
```

## Clean fermentation data

```{r}
ri_fermentation_data |>
  filter(Exp == "RI_batch_WC1") |>
  select( "Rowname" | (starts_with("T") & ends_with("h")) ) |>
  select(where(~!all(is.na(.x)) ) ) |>
  write_csv("../data/02_fermentation_data_clean.csv")
```
